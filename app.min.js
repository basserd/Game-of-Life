var alive_blocks=[],canvas_paused=true,canvas_count=0;(function($){var canvas_interval=window.setInterval(function(){if(!window.canvas_paused){set_next_step_canvas();}},200);function get_blocks(){var horizontal_blocks=$(".horizontal_block");return !horizontal_blocks.length?false:horizontal_blocks;}function get_blocks_by_row(row){if(!row){return false;}var horizontal_blocks=$('.horizontal_block[data-vertical="'+row+'"]');return !horizontal_blocks.length?false:horizontal_blocks;}function get_rows(){var vertical_rows=$(".vertical_row");return !vertical_rows.length?false:vertical_rows;}function get_random_from_array(arr,n){var result=new Array(n),len=arr.length,taken=new Array(len);if(n>len){throw new RangeError("getRandom: more elements taken than available");}while(n--){var x=Math.floor(Math.random()*len);result[n]=arr[x in taken?taken[x]:x];taken[x]=--len in taken?taken[len]:len;}return result;}$(document).ready(function(){if($(".horizontal_block").length){}});$(document).on("click",".horizontal_block",function(){var $this=$(this);if($this.length){toggle_alive_horizontal_block($this);}}).on("click",'button[data-action="recalculate_canvas"]',function(){if($(".horizontal_block").length){if(typeof window.canvas_count!="undefined"){window.canvas_count=0;canvas_set_current_count();}set_random_horizontal_alive_blocks();}}).on("click",'button[data-action="next_step_canvas"]',function(){if($(".horizontal_block").length){set_next_step_canvas();}}).on("click",'button[data-action="play_canvas"]',function(){if(window.canvas_paused){window.canvas_paused=false;}}).on("click",'button[data-action="pause_canvas"]',function(){if(!window.canvas_paused){window.canvas_paused=true;}}).on("click",'button[data-action="reset_canvas"]',function(){if(!window.canvas_paused){window.canvas_paused=true;}remove_alive_horizontal_block();});function set_random_horizontal_alive_blocks(){var horizontal_blocks=get_blocks();var existing_horizontal_blocks=$(".horizontal_block.alive");if(existing_horizontal_blocks.length){existing_horizontal_blocks.removeClass("alive");}var $horizontal_amount=200;var random_defined_alive=$(get_random_from_array(horizontal_blocks,$horizontal_amount)).addClass("alive");var possible_neighbors=(typeof window.possible_neighbors!="undefined")?window.possible_neighbors:false;if(possible_neighbors!=false){if(typeof window.alive_blocks!="undefined"){$.each(window.alive_blocks,function(index,data){$('.horizontal_block[data-verical-horizontal="'+index+'"]').removeClass("alive");});window.alive_blocks=[];}$.each(random_defined_alive,function(index,element){var combination_v_h=$(element).data("vertical")+"_"+$(element).data("horizontal");if(typeof possible_neighbors[combination_v_h]=="undefined"){remove_alive_horizontal_block();}window.alive_blocks[combination_v_h]={status:"alive",neighbors:possible_neighbors[combination_v_h]};});}if(!window.canvas_paused){window.canvas_paused=true;}}function amount_direct_alive_neighbors(v_block,h_block,neighbors){if(v_block&&h_block&&neighbors){var current_block_active_count=0;for(var key_v in neighbors){var obj_v=neighbors[key_v];for(var key_h in obj_v){if((v_block+"_"+h_block)!=(key_v+"_"+key_h)&&window.alive_blocks[key_v+"_"+key_h]){current_block_active_count++;}}}return current_block_active_count;}return false;}function direct_eligible_alive_neighbors(neighbors){var alive_blocks=typeof window.alive_blocks!="undefined"?window.alive_blocks:false;if(neighbors){var new_alive_blocks=[];for(var key_v in neighbors){var obj_v=neighbors[key_v];for(var key_h in obj_v){var iteration_key=key_v+"_"+key_h,iteration_neighbors=window.possible_neighbors[iteration_key];if(iteration_neighbors){var iteration_direct_alive_amount=amount_direct_alive_neighbors(key_v,key_h,iteration_neighbors);if(iteration_direct_alive_amount==3&&((alive_blocks!==false&&typeof alive_blocks[iteration_key]=="undefined")||alive_blocks==false&&typeof new_alive_blocks[iteration_key]=="undefined")){new_alive_blocks.push(iteration_key);}}}}if(new_alive_blocks.length>0){return new_alive_blocks;}}return false;}function set_next_step_canvas(){var possible_neighbors=(typeof window.possible_neighbors!="undefined")?window.possible_neighbors:false,alive_blocks=(typeof window.alive_blocks!="undefined")?window.alive_blocks:false,deleted_blocks=[],added_blocks=[];if(!possible_neighbors||!alive_blocks){return false;}for(var key in alive_blocks){var obj=alive_blocks[key],v_block=key.split("_")[0],h_block=key.split("_")[1],amount_alive_neighbors=amount_direct_alive_neighbors(v_block,h_block,obj.neighbors),possible_new_alive_blocks=direct_eligible_alive_neighbors(obj.neighbors);if(amount_alive_neighbors<2||amount_alive_neighbors>3){deleted_blocks.push(key);}if(possible_new_alive_blocks!==false){for(var key_new in possible_new_alive_blocks){if(added_blocks.indexOf(possible_new_alive_blocks[key_new])==-1){added_blocks.push(possible_new_alive_blocks[key_new]);}}}}if(added_blocks.length){for(var key_a in added_blocks){window.alive_blocks[added_blocks[key_a]]={status:"alive",neighbors:possible_neighbors[added_blocks[key_a]]};$('.horizontal_block[data-vertical-horizontal="'+added_blocks[key_a]+'"]').addClass("alive");}}if(deleted_blocks.length){for(var key_d in deleted_blocks){delete window.alive_blocks[deleted_blocks[key_d]];$('.horizontal_block[data-vertical-horizontal="'+deleted_blocks[key_d]+'"]').removeClass("alive");}}if(typeof window.canvas_count!="undefined"){window.canvas_count++;canvas_set_current_count();}}function toggle_alive_horizontal_block(this_element){this_element.toggleClass("alive");var possible_neighbors=typeof window.possible_neighbors!="undefined"?window.possible_neighbors:false;if(typeof window.alive_blocks!="undefined"){var alive_blocks=window.alive_blocks;var this_element_pos=this_element.data("vertical-horizontal");if(typeof alive_blocks[this_element_pos]!="undefined"){delete window.alive_blocks[this_element_pos];}else{window.alive_blocks[this_element_pos]={status:"alive",neighbors:possible_neighbors[this_element_pos]};}}}function remove_alive_horizontal_block(){if(typeof window.alive_blocks!="undefined"){for(var key_alive in window.alive_blocks){$('.horizontal_block[data-vertical-horizontal="'+key_alive+'"]').removeClass("alive");}window.alive_blocks=[];if(typeof window.canvas_count!="undefined"){window.canvas_count=0;canvas_set_current_count();}}}function canvas_set_current_count(){var canvas_count_container=$(".canvas_count__generations");if(canvas_count_container.length){var canvas_count_number=canvas_count_container.find("span.number");if(canvas_count_number.length){$(canvas_count_number).text(window.canvas_count);}}}})(jQuery);