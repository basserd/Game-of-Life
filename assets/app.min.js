!function(n){var i=[],o=!0,a=0,t=10,e=setInterval(l,5e3/t);function r(){o||(e=setInterval(l,5e3/t))}function l(){o||h()}function c(){clearInterval(e)}function s(n,o,a){if(n&&o&&a){var t=0;for(var e in a){var r=a[e];for(var l in r)n+"_"+o!=e+"_"+l&&i[e+"_"+l]&&t++}return t}return!1}function v(n){var o=void 0!==i&&i;if(n){var a=[];for(var t in n){var e=n[t];for(var r in e){var l=t+"_"+r,c=window.possible_neighbors[l];if(c)3==s(t,r,c)&&(!1!==o&&void 0===o[l]||0==o&&void 0===a[l])&&a.push(l)}}if(a.length>0)return a}return!1}function h(){var o=void 0!==window.possible_neighbors&&window.possible_neighbors,t=void 0!==i&&i,e=[],r=[];if(!o||!t)return!1;for(var l in t){var c=t[l],h=s(l.split("_")[0],l.split("_")[1],c.neighbors),d=v(c.neighbors);if((h<2||h>3)&&e.push(l),!1!==d)for(var _ in d)-1==r.indexOf(d[_])&&r.push(d[_])}if(r.length)for(var f in r)i[r[f]]={status:"alive",neighbors:o[r[f]]},n('.horizontal_block[data-vertical-horizontal="'+r[f]+'"]').addClass("alive");if(e.length)for(var w in e)delete i[e[w]],n('.horizontal_block[data-vertical-horizontal="'+e[w]+'"]').removeClass("alive");void 0!==a&&(a++,u())}function d(){if(void 0!==i){for(var o in i)n('.horizontal_block[data-vertical-horizontal="'+o+'"]').removeClass("alive");i=[],void 0!==a&&(a=0,console.log("remove: "),u())}}function u(){console.log(t);var i=n(".canvas_count__generations");if(i.length){var o=i.find("span.number");o.length&&n(o).text(a)}}n(document).ready(function(){var i=n(".canvas_container");i.length&&(window.innerWidth<i.width()||window.innerHeight<i.height()||window.innerWidth-100>i.width()||window.innerHeight-100>i.height())&&function(i){var o=i.data("v_blocks"),a=i.data("h_blocks");if(a&&o){var t=n("#horizontal_block_style"),e=(window.innerWidth-30)/a,r=window.innerWidth-30;t.length&&e&&(window.innerWidth>window.innerHeight&&(e=(window.innerHeight-30)/o,r=window.innerHeight-30),n(i).closest(".canvas_container_outer").css("width",r+"px"),n("style#horizontal_block_style").remove(),n(".page_container").append(n('<style id="#horizontal_block_style">.vertical_row{height:'+e+"px!important;}.vertical_row .horizontal_block{width:"+e+"px!important;height:"+e+"px!important;}</style>")))}}(i)}),n(document).on("click",".horizontal_block",function(){var o=n(this);o.length&&function(n){n.toggleClass("alive");var o=void 0!==window.possible_neighbors&&window.possible_neighbors;if(void 0!==i){var a=i,t=n.data("vertical-horizontal");void 0!==a[t]?delete i[t]:i[t]={status:"alive",neighbors:o[t]}}}(o)}).on("click",'button[data-action="recalculate_canvas"]',function(){n(".horizontal_block").length&&(void 0!==a&&(a=0,u(),c()),function(){var a=(e=n(".horizontal_block"),!!e.length&&e),t=n(".horizontal_block.alive");var e;t.length&&t.removeClass("alive");var r=n(function(n,i){var o=new Array(i),a=n.length,t=new Array(a);if(i>a)throw new RangeError("getRandom: more elements taken than available");for(;i--;){var e=Math.floor(Math.random()*a);o[i]=n[e in t?t[e]:e],t[e]=--a in t?t[a]:a}return o}(a,200)).addClass("alive"),l=void 0!==window.possible_neighbors&&window.possible_neighbors;0!=l&&(void 0!==i&&(n.each(i,function(i,o){n('.horizontal_block[data-verical-horizontal="'+i+'"]').removeClass("alive")}),i=[]),n.each(r,function(o,a){var t=n(a).data("vertical")+"_"+n(a).data("horizontal");void 0===l[t]&&d(),i[t]={status:"alive",neighbors:l[t]}}));o||(o=!0)}())}).on("click",'button[data-action="next_step_canvas"]',function(){n(".horizontal_block").length&&h()}).on("click",'button[data-action="play_canvas"]',function(){o&&(o=!1,r())}).on("click",'button[data-action="pause_canvas"]',function(){o||(o=!0,c())}).on("click",'button[data-action="reset_canvas"]',function(){o||(o=!0,c()),d()}).on("keyup","input.canvas_input",function(){var i=n(this);if(i.length&&""!=i.attr("name"))switch(i.attr("name")){case"canvas_amount_per_5":void 0!==t&&parseInt(i.val())&&(t=parseInt(i.val()),c(),r(),console.log("case 31231"))}})}(jQuery);